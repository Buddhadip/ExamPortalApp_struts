package com.exam.action;


import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;


import org.apache.struts.action.Action;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.upload.FormFile;

import com.exam.form.FileUploadForm;

public class UploadCsvAction extends Action {
	public ActionForward execute(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) throws Exception {
				System.out.println(form);
				FileUploadForm fileUploadForm = (FileUploadForm)form;
			    FormFile file = fileUploadForm.getFile();	
			    System.out.println(file.getFileName());
			    String fileContent = readFileContent(file);

		        // Print the file content
		        System.out.println("File Content:\n" + fileContent);
			    
			    
				return mapping.findForward("success");
		
	}
	
	private String readFileContent(FormFile file) throws IOException {
        InputStream inputStream = file.getInputStream();
        BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream));

        StringBuilder fileContent = new StringBuilder();
        String line;
        while ((line = reader.readLine()) != null) {
            fileContent.append(line).append("\n");
        }

        reader.close();
        inputStream.close();

        return fileContent.toString();
    }
}